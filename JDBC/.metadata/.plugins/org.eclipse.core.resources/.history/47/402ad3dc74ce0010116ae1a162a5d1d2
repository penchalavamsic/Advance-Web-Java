package com.subquery;
import java.sql.*;


public class SubQueries {
    public static void main(String[] args) {

        String url = "jdbc:mysql://localhost:3306/yourDBName";
        String user = "root";
        String pass = "yourPassword";

        Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

        try {
            Class.forName("com.mysql.cj.jdbc.Driver");

            con = DriverManager.getConnection(url, user, pass);

            String query = "SELECT cid, cname, city, balance " +
                           "FROM customers " +
                           "WHERE balance = (SELECT MAX(balance) FROM customers)";

            ps = con.prepareStatement(query);

            rs = ps.executeQuery();

            System.out.println("Customer(s) having Maximum Balance:");

            while (rs.next()) {
                System.out.println("CID     : " + rs.getInt("cid"));
                System.out.println("Name    : " + rs.getString("cname"));
                System.out.println("City    : " + rs.getString("city"));
                System.out.println("Balance : " + rs.getDouble("balance"));
                System.out.println("---------------------------------------");
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            try { if (rs != null) rs.close(); } catch (Exception ex) {}
            try { if (ps != null) ps.close(); } catch (Exception ex) {}
            try { if (con != null) con.close(); } catch (Exception ex) {}
        }
    }
}
